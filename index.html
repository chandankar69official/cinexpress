<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CineXpress Viewer</title>
  <style>
    body {font-family: Arial, sans-serif; background:#111; color:#fff; margin:0; padding:0;}
    header {background:#e50914; padding:15px; text-align:center; font-size:1.5rem; font-weight:bold;}
    .container {padding:20px; max-width:1200px; margin:auto;}
    .search-box {width:100%; padding:10px; margin-bottom:15px; border-radius:6px; border:none;}
    .categories {margin-bottom:20px;}
    .categories button {background:#333; color:#fff; border:none; padding:6px 12px; margin:3px; border-radius:5px; cursor:pointer;}
    .categories button.active {background:#e50914;}
    .grid {display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px;}
    .card {background:#1d1d1d; padding:10px; border-radius:8px;}
    .card img {width:100%; height:280px; object-fit:cover; border-radius:6px;}
    .card h3 {margin:10px 0 5px;}
    .card p {font-size:.9rem; color:#ccc;}
    .links button {background:#e50914; color:#fff; border:none; padding:5px 10px; margin:3px; border-radius:5px; cursor:pointer;}
    .links button:hover {background:#c40812;}
    .pagination {text-align:center; margin-top:20px;}
    .pagination button {margin:3px; padding:6px 10px; border:none; border-radius:5px; cursor:pointer;}
    .pagination button.active {background:#e50914; color:#fff;}
    footer {background:#222; text-align:center; padding:15px; margin-top:30px; font-size:.9rem;}
  </style>
</head>
<body>
  <header>ðŸŽ¬ CineXpress</header>
  <div class="container">
    <input type="text" id="search" class="search-box" placeholder="Search movies...">
    <div class="categories" id="categories"></div>
    <div class="grid" id="movieGrid"></div>
    <div class="pagination" id="pagination"></div>
  </div>
  <footer>Â© 2025 CineXpress by Chandan Kar</footer>

  <script>
    let movies = JSON.parse(localStorage.getItem("movies")) || [];
    let currentPage = 1;
    const perPage = 10;
    let currentCategory = "All";
    let searchText = "";

    const categoryList = ["All","Hollywood","Bollywood","AnimeFlix","Web Series","Latest"];

    function renderCategories() {
      const catDiv = document.getElementById("categories");
      catDiv.innerHTML = "";
      categoryList.forEach(cat => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        if (cat === currentCategory) btn.classList.add("active");
        btn.onclick = () => { currentCategory = cat; currentPage=1; renderMovies(); renderCategories(); };
        catDiv.appendChild(btn);
      });
    }

    function renderMovies() {
      let filtered = movies.slice().reverse(); // newest first
      if (currentCategory !== "All") {
        filtered = filtered.filter(m => m.categories.includes(currentCategory));
      }
      if (searchText.trim() !== "") {
        filtered = filtered.filter(m => m.title.toLowerCase().includes(searchText.toLowerCase()));
      }

      const start = (currentPage-1)*perPage;
      const pageMovies = filtered.slice(start, start+perPage);

      const grid = document.getElementById("movieGrid");
      grid.innerHTML = "";
      pageMovies.forEach(m => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${m.poster || 'https://via.placeholder.com/300x400'}">
          <h3>${m.title}</h3>
          <p>${m.description || ""}</p>
          <div class="links">
            ${m.links.link480 ? `<button onclick="openLink('${m.links.link480}')">480p</button>` : ""}
            ${m.links.link720 ? `<button onclick="openLink('${m.links.link720}')">720p</button>` : ""}
            ${m.links.link1080 ? `<button onclick="openLink('${m.links.link1080}')">1080p</button>` : ""}
            ${m.links.link4k ? `<button onclick="openLink('${m.links.link4k}')">4K</button>` : ""}
          </div>
        `;
        grid.appendChild(card);
      });

      renderPagination(filtered.length);
    }

    function renderPagination(total) {
      const pagDiv = document.getElementById("pagination");
      pagDiv.innerHTML = "";
      const totalPages = Math.ceil(total / perPage);
      for (let i=1;i<=totalPages;i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        if (i===currentPage) btn.classList.add("active");
        btn.onclick = () => {currentPage=i; renderMovies();};
        pagDiv.appendChild(btn);
      }
    }

    function openLink(url) {
      window.open(url,"_blank");
    }

    document.getElementById("search").addEventListener("input", e => {
      searchText = e.target.value;
      currentPage = 1;
      renderMovies();
    });

    renderCategories();
    renderMovies();
  </script>
</body>
</html>
